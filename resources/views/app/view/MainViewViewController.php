/*
 * File: app/view/MainViewViewController.js
 *
 * This file was generated by Sencha Architect version 3.2.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 5.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 5.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.MainViewViewController',
{
	extend : 'Ext.app.ViewController',
	alias : 'controller.mainview',
	onTreepanelItemClick : function (dataview, record, item, index, e, eOpts)
	{
		var me = this;
		if (!record.data.leaf)
		{
			return;
		}
		var new_tab = Ext.create(record.data.view_class,
			{
				title : record.data.text
			}
			);
		var con_panel = me.lookupReference('content_panel');
		var item_arr = [];
		con_panel.items.each(function (item)
		{
			item_arr.push(item.reference);
		}
		);
		if (item_arr.indexOf(new_tab.reference) == -1)
		{
			con_panel.add(new_tab);
			con_panel.setActiveTab(new_tab);
		}
		else
		{
			con_panel.setActiveTab(item_arr.indexOf(new_tab.reference));
		}

	},
	onMainViewAfterRender : function (component, eOpts)
	{
		var updateClock = function ()
		{
			var date = new Date();
			var days = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];
			var clock = Ext.util.Format.date(date, 'Y年n月j日');
			clock += ' ' + days[date.getDay()] + ' ';
			clock += Ext.util.Format.date(date, 'H时i分');
			Ext.ComponentQuery.query('#clockTbtext')[0].setText(clock);
		};
		updateClock();
		var runner = Ext.create('Ext.util.TaskRunner');
		var clockTask = (
		{
			run : function ()
			{
				updateClock();
			},
			interval : 1000 * 60
		}
		);
		Ext.TaskManager.start(clockTask);
	},
	onMycombobox1Change : function ()
	{
	},
	onMycombobox1Afterrender : function (component, eOpts)
	{

	},
	onMainViewportLeftPanelExpand : function (panel, eOpts)
	{
	},
	OnappTreepanelAfterrender : function (view,eOpts)
	{
		//var myStore = Ext.create('Ext.data.TreeStore',
		//{
		//	proxy :
		//	{
		//		type : 'ajax',
		//		url : window.location.href + 'fn/menu.php',
		//		reader :
		//		{
		//			type : 'json',
		//			rootProperty : 'children'
		//		}
		//	}
		//}
		//);
		//myStore.load();
		//view.bindStore(myStore);
	}
}
);
